
==== Mock-ups, data structures and XML examples

The two next chapters describe in detail the different *types* of exclusion and selection criteria defined and used in the ESPD-EDM. By *type* of criterion we refer to criteria that share common characteristics, namely how they are structured. Each type of criterion is presented from three perspectives:      

. *Layout and functional*: Mock-ups are provided to explain which data are expected and, to some extent, how software applications should behave (what to show/hide, validate or process depending on variables like 'what the user answers' or 'which is the role of the user'). Mock-ups are provided for both the contracting authority and economic operator perspectives; 

. *Structural*: two spread-sheet books (two files) are provided with this document aimed to explain how each type of criterion is organised:

** ESPD-Data_Structures-REGULATED-V02.00.00.xlsx, where the structures of the REGULATED ESPD criteria are defined;

** ESPD-Data_Structures-SELFCONTAINED-V02.00.00.xlsx, where the structures of the SELF-CONTAINE ESPD criteria are defined;  
 
Each book (file) contains different sheets (tabs). Each 'tab' shows the structure of one type of criterion (e.g. 'EG-Convictions', 'EG-Contributions', ..., 'SC-Suitability', 'SC_References', etc.; where 'EG' stands for 'Exclusion Grounds', and 'SC' stands for 'Selection Criteria').    

. *XML Implementation*: 


Each mock-up (or pair of CA + EO mock-ups) represent the structure represented in the data structure spread-sheet and in the supplied XML example. Whilst the mock-up and XML example are quite self-explanatory, to understand the value of the data structure spread-sheet needs to be explained; which is the mission of this very next sub-section below.

==== Data structures

The ESPD-EDM 'criterion' entity is a very flexible and business-agnostic structure. This flexibility provides a convenient way to represent any type of criteria. The counterpart is that the semantics of the criteria needs to be delimited based on codes, identifiers and design rules.

Hence this document proposes a way of representing the criteria following a regular method and providing concrete codes to specify types of criterion properties, and identifiers to distinguish the different criteria and *reusable* groups of properties (when studying these data groups you will observe that sub-groups of properties are reused in different criteria have identical identifiers and structures).  

The following two figures below illustrate the data structure sheets for one simple exclusion criterion (EG-Contributions) from both versions of the ESPD, REGULATED and SELF-CONTAINED. Compare them with the UBL-2.2 `cac:TenderingCriterion` XSD element.

*REGULATED*

.Regulated 'Contributions' criterion data structure 
image::Regulated_ESPDRequest_Contributions_Data_Structure.png[Regulated 'Contributions' criterion data structure, alt="Regulated 'Contributions' criterion data structure",align="center"]

*SELF-CONTAINED*

.Self-contained 'Contributions' criterion data structure 
image::Selfcontained_ESPDRequest_Contributions_Data_Structure.png[Self-contained 'Contributions' criterion data structure, alt="Self-contained 'Contributions' criterion data structure", align="center"]

We could say that the 'data structures' represented in the spread-sheets define a kind of 'meta-language' (or 'controlled vocabulary') that helps 'map' the structure of an ESPD-EDM criterion and the UBL-2.2 criterion data structure. The table below 'maps' both vocabularies. Please compare any of the data structures provided in this document with both the UBL-2.2 XSD Schemas and the XML examples provided herein.

.Mapping between the ESPD-EDM criterion data structure spread-sheets and the UBL-2.2 vocabulary 
|===
|*ESDP-EDM Spread-sheet vocabulary*|*UBL-2.2 vocabulary*
|CRITERION|cac:TenderingCriterion
|SUBCRITERION|cac:SubTenderingCriterion
|REQUIREMENT_GROUP|cac:TenderingCriterionPropertyGroup
|QUESTION_GROUP|cac:TenderingCriterionPropertyGroup
|REQUIREMENT_SUBGROUP|cac:SubsidiaryTenderingCriterionPropertyGroup
|QUESTION_SUBGROUP|cac:SubsidiaryTenderingCriterionPropertyGroup
|CAPTION|cac:TenderingCriterionProperty
|REQUIREMENT|cac:TenderingCriterionProperty
|QUESTION|cac:TenderingCriterionProperty
|ADDITIONAL_DESCRIPTION_LINE|cbc:Description (namely in cac:TenderingCriterion)
|LEGISLATION|cac:Legislation
|===
  
The ESPD-EDM data structures vocabulary is defined in the Code List "link:./dist/cl/ods/ESPD-CodeLists-V02.00.00.ods[CriterionElementType]". Her you have the definitions provided therein:

* CRITERION: A criterion (in the case of the the ESPD an Exclusion or Selection criterion); maps to a UBL-2.2 cac:TenderingCriterion class
* SUBCRITERION: Used to define national sub-criteria; maps to a UBL-2.2 cac:SubTenderingCriterion class 
* REQUIREMENT_GROUP: Group of requirements or remarks issued by a MS or a CA; maps to a UBL-2.2 cac:TenderingCriterionPropertyGroup
* REQUIREMENT_SUBGROUP: A subgroup of requirements or remarks inside a group or subgroup of requirements; maps to a UBL-2.2 cac:SubsidiaryTenderingCriterionPropertyGroup
* REQUIREMENT: Requirement, remark, rule, restriction or additional information to which the EO needs to conform or comply with; maps to a cac:TenderingCriterionProperty class (one data type must be specified for the value supplied by the contracting authority (CA); see see codes in the Code List "link:./dist/cl/ods/ESPD-CodeLists-V02.00.00.ods[ResponseDataType]") 
* QUESTION_GROUP: Group of questions, each question requiring a datum as an answer from the EO; maps to a cac:TenderingCriterionPropertyGroup class 
* QUESTION_SUBGROUP:	A subgroup of questions inside a group or a subgroup of questions; maps to a cac:SubsidiaryTenderingCriterionPropertyGroup
* QUESTION: A	question that requires an answer (a specific datum) from the EO; maps to a cac:TenderingCriterionProperty class (one, and only one, data type is expected; see codes in the Code List "link:./dist/cl/ods/ESPD-CodeLists-V02.00.00.ods[ResponseDataType]" )
* CAPTION: A text label (no requirement nor answer is expected); maps to a cac:TenderingCriterionProperty class (the expected response data type is NONE) 
* ADDITIONAL_DESCRIPTION_LINE:	Additional line in a description (for descriptions that can be split in several lines); maps to a cbc:Description element (namely in cac:TenderingCriterion) 
* LEGISLATION:	An instance of a Legislation class; maps to a cac:Legislation class


*The main differences between REQUIREMENT, CAPTION and QUESTION are*:

. A REQUIREMENT is a condition, restriction or rule established by the Member State (in e-Certis, for all procurement procedures) or the contracting authority (CA, for the specific procurement procedure). REQUIREMENTs are not intended to be responded by the economic operator; but the economic operator must conform to (comply with) it. Examples of REQUIREMENTs: 'Provide at least three references to similar works', 'The expected lowest general yearly turnover is 1,000,000 â‚¬', etc. (see mock-ups). 

. A CAPTION is a label normally used to introduce a group of REQUIREMENTs or QUESTIONs; e.g. 'Lots the EO tenders to' (which is followed by a list of Lots identifiers provided by the EO);

. A QUESTION is a direct request of a specific datum issued by the MS or the CA and addressed to the EO. The EO has to respond this QUESTION with a value of the expected type of data.


If you examine any of the XML examples provided in this document you will observe that:

* SUBCRITERION is reserved to specify national criteria. The Regulated ESPD documents do not specify SUBCRITERIA. The SELF-CONTAINED version does;

* The Regulated ESPD documents do not specify REQUIREMENTs, only QUESTIONs. The SELF-CONTAINED version does;

* The reason for having 'groups' and 'sub-groups' of properties is because UBL-2.2 defined the 'TenderingCriterionPropertyGroup' and 'SubsidiaryTenderingCriterionPropertyGroup';

* In the SELF-CONTAINED version the following rules apply in a regular way:
 
** When the member state (MS) or the contracting authority (CA) needs to specify REQUIREMENTs, the outer group of the data structure is always a REQUIREMENT_GROUP (e.g. 'EG-Contributions', 'SC-Suitability', or practically all selection criteria). Otherwise the outer group is always a QUESTION_GROUP (e.g. 'EG-Convictions', 'EG-Environ-Social-Labour_Law', 'EG-Business', etc.) 

** A REQUIREMENT_GROUP always contain a first element CAPTION or REQUIREMENT. This is because in the UBL-2.2 XSD schema the first *mandatory* element is always a `cac:TenderingCriterionProperty` element;

** A REQUIREMENT_GROUP or REQUIREMENT-SUBGROUP may contain either REQUIREMENT_SUBGROUPS and/or QUESTION_SUBGROUPS;   

** The only possibility in the UBL-2.2 model to distinguish whether a group or a subgroup of criterion properties contains REQUIREMENTs or QUESTIONs is to look into the value of the `cac:TenderingCriterionProperty/cbc:TypeCode`. The list of possible codes are the ones of the above mentioned Code List "link:./dist/cl/ods/ESPD-CodeLists-V02.00.00.ods[CriterionElementType]".  

==== Data structures as a tool to generate XML instances





 

      